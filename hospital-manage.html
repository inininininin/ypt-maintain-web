<!DOCTYPE html>
<html>

<head>

    <title>医品通-运维-医院管理</title>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon" />

    <script src="https://lib.sinaapp.com/js/jquery/1.9.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://lib.sinaapp.com/js/bootstrap/3.3.7/css/bootstrap.min.css" />
    <script src="./other/layui-v2.5.5/layui.all.js"></script>
    <link rel="stylesheet" href="./other/layui-v2.5.5/css/layui.css" />

    <script src="./other/zTree_v3/js/jquery.ztree.all.js"></script>
    <link rel="stylesheet" href="./other/zTree_v3/css/zTreeStyle/zTreeStyle.css" type="text/css">

    <link rel="stylesheet" type="text/css" href="./other/jquery-easyui-1.8.7/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="./other/jquery-easyui-1.8.7/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="./other/jquery-easyui-1.8.7/demo/demo.css">
    <script type="text/javascript" src="./other/jquery-easyui-1.8.7/jquery.easyui.min.js"></script>

    <link rel="stylesheet" href="./other/jQueryViewer20160329/css/viewer.min.css">
    <script src="./other/jQueryViewer20160329/js/viewer.min.js"></script>
    <script src="./other/jQueryViewer20160329/js/viewer-jquery.min.js"></script>

    <script src="./other/moment.js"></script>
    <script src="./other/common.js"></script>




    <style>

    </style>

    <script>
        var queryStringObject = common.queryStringObject();

        var queryParam = {}, currentRows = [], sum = {}

        $(document).ready(function () {

            $('.datagrid-dom').datagrid({
            columns: [[
                {
                    field: 'cover', title: '封面', width: 60, align: 'center', halign: 'center', formatter: function (value, row, index) {
                        return value ? `<span class="image-previewer"><img src='${value}' style='width:50px' data-original='${value}'/></span>` : value
                    }
                },
                { field: 'remark', title: '备注', width: 200, align: 'left', halign: 'center' },
                {
                    field: 'frozen', title: '冻结', width: 50, align: 'center', halign: 'center', formatter: function (value, row, index) {
                        return value == 1 ? '是' : '否';
                    }
                },
                { field: 'orderNo', title: '排序号', width: 70, align: 'right', sortable: true, halign: 'center' },
                {
                    field: 'addTime', title: '添加时间', width: 165, align: 'left', sortable: true, halign: 'center', formatter: function (value, row, index) {
                        return value ? moment(value).format('YYYY-MM-DD HH:mm:ss') : value;
                    }
                }
            ]],
            frozenColumns: [[
                { field: 'ck', align: 'left', checkbox: true },
                {
                    field: 'name', title: '名称', width: 250, align: 'left', halign: 'center', formatter: function (value, row, index) {
                        debugger
                        if (value == '汇总：')
                            return value;
                        return `<a href="JavaScript:void(0)" style="width:100%;display:inline-block;" title="${value || ''}" onclick="maintainCommon.newTab('文章:${common.subOmitRight(row.name, 10)}','/maintain/article.html?articleId=${row.articleId}')">${value}</a>`;
                    }, styler: function (value, row, index) {
                        return ``
                    }
                }
            ]],
            idField: 'hospitalId',
            pagination: true,
            rownumbers: true,
            emptyMsg: '无数据',
            singleSelect: false,
            ctrlSelect: true,
            checkOnSelect: true,
            selectOnCheck: true,
            multiSort: true,
            autoRowHeight: false,
            rowStyler: function (index, row) {

            },
            loader: function (param, success, error) {
                debugger
                queryParam.ps = param.rows;
                queryParam.pn = param.page;
                $.get('/maintain/hospitals', queryParam, function (data) {
                    if (data.codeMsg)
                        alert(data.codeMsg)
                    if (data.code == 0) {
                        currentRows = data.data.rows;
                        $.get('/maintain/hospitals-sum', queryParam, function (data) {
                            if (data.codeMsg)
                                alert(data.codeMsg)
                            if (data.code == 0) {
                                sum = data.data;
                            }
                        })
                        success({rows:currentRows,sum:sum});
                    } else {

                    }
                })
            },
            loadFilter: function (data) {
                debugger
                var fdata = {
                    rows: data.rows, total: data.sum.rowCount
                }
                return fdata;
            }, onLoadSuccess: function () {
                $('.image-previewer').viewer({
                    url: 'data-original',
                })
            }
        });
        });




        $.parser.onComplete = function () {
            $(".loading-dom").remove();
        }



       

    </script>
</head>



<body style="margin:0;padding:0;">
    <div class='loading-dom' style="position: absolute; z-index: 1000; top: 0px; left: 0px; 
    width: 100%; height: 100%; background: white; text-align: center;padding:5px 10px">
        <font>loading···</font>
    </div>


    <a href="JavaScript:void(0)" class="easyui-linkbutton" iconCls="icon-search"
                onclick="$('.datagrid-dom').datagrid('load').datagrid('clearChecked');">查询</a>
    <div style="padding:2px 5px;">

            <input name="kw" class="easyui-textbox" label="关键字:" labelPosition="left" labelAlign="right" data-options="
        iconWidth:20,
        icons:[{
            iconCls:'icon-clear',
            handler: function(e){
                $(e.data.target).textbox('setValue','');
            }
        }],
        onChange:function(newValue, oldValue){
            queryParam.kw=newValue
        }" style="width:300px" />




            <table class="easyui-datagrid datagrid-dom" style="width:100%;min-height:420px">
            </table>
            <!-- 
            <span style='display:inline-block;margin-top:5px;margin-left:5px;'>
                <span style="">类型1:</span>
                <input class="easyui-combobox" name="articleType1Id" style="width:200px;" data-options="
    valueField:'articleTypeId',
    textField:'name',
    panelHeight:'auto',
    mode:'remote',
    onShowPanel:function(){
        $(this).combobox('reload')
    },
    loader: function (param, success, error) {
        debugger
        param.kw=param.q;
        param.ps = param.rows;
        param.pn = param.page;
        $.ajax({
            url: '/maintain/article-types',
            type: 'get',
            data: param,
            success: function (data) {
                if (data.code != 0) {
                    return false;
                } else {
                    success(data.data);
                }

            }
        })
    },
    onChange:function(newValue, oldValue){
        rowsPad.data.queryParam.articleType1Id=newValue
    },
    loadFilter: function (data) {
        debugger
        return data.rows;
    },
    iconWidth:20,
    icons:[{
        iconCls:'icon-clear',
        handler: function(e){
            $(e.data.target).combobox('setValue','');
        }
    }]
    "></span>


            <span style='display:inline-block;margin-top:5px;margin-left:5px;'>
                <span style="">类型2:</span>
                <input class="easyui-combobox" name="articleType2Id" style="width:200px;" data-options="
            valueField:'articleTypeId',
            textField:'name',
            panelHeight:'auto',
            mode:'remote',
            onShowPanel:function(){
                $(this).combobox('reload')
            },
            loader: function (param, success, error) {
                debugger
                if(!rowsPad.data.queryParam.articleType1Id)
                    return;
                param.kw=param.q;
                param.ps = param.rows;
                param.pn = param.page;
                param.upperId = rowsPad.data.queryParam.articleType1Id;
                $.ajax({
                    url: '/maintain/article-types',
                    type: 'get',
                    data: param,
                    success: function (data) {
                        if (data.code != 0) {
                            return false;
                        } else {
                            success(data.data);
                        }

                    }
                })
            },
            onChange:function(newValue, oldValue){
                rowsPad.data.queryParam.articleType2Id=newValue
            },
            loadFilter: function (data) {
                debugger
                return data.rows;
            },
            iconWidth:20,
            icons:[{
                iconCls:'icon-clear',
                handler: function(e){
                    $(e.data.target).combobox('setValue','');
                }
            }]
            "></span>

            <span style='display:inline-block;margin-top:5px;margin-left:5px;'>
                <span style="">添加时间 From:</span>
                <input name="addTimeFrom" class="easyui-datebox" style="width:135px" data-options="
            editable:false,
            icons:[{
                iconCls:'icon-clear',
                handler: function(e){
                    $(e.data.target).datebox('setValue','');
                }
            }],
        onChange:function(newValue, oldValue){
            rowsPad.data.queryParam.addTimeFrom=newValue
        }">
            </span>

            <span style='display:inline-block;margin-top:5px;margin-left:5px;'>
                <span style="">To:</span>
                <input name="addTimeTo" class="easyui-datebox" style="width:135px" data-options="
            editable:false,
            icons:[{
                iconCls:'icon-clear',
                handler: function(e){
                    $(e.data.target).datebox('setValue','');
                }
            }],
    onChange:function(newValue, oldValue){
        rowsPad.data.queryParam.addTimeTo=newValue
    }"></span>

            <span style='display:inline-block;margin-top:5px;margin-left:5px;'>
                <span style="">&nbsp;冻结:</span>
                <input name="frozen" class="easyui-combobox" style="width:80px" data-options="editable:false,panelHeight:'auto',value:'',data:[
       {
                                     text: '否',
                                     value: '0'
                                 },{
                                     text: '是',
                                     value: '1'
                                 }],
        iconWidth:20,
        icons:[{
            iconCls:'icon-clear',
            handler: function(e){
                $(e.data.target).combobox('setValue','');
            }
        }],
        onChange:function(newValue, oldValue){
            rowsPad.data.queryParam.frozen=newValue
        }" />
            </span>
 -->

        </div>

</body>


</html>